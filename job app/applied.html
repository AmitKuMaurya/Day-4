<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Database</title>
    <link rel="stylesheet" href="commonStyles.css" />
  </head>

  <body>
    <div id="links">
      <div><a href="index.html">Home</a></div>
      <div><a href="applied.html">Applied Jobs</a></div>
      <div><a href="bookmark.html">Bookmarks</a></div>
    </div>

    <select id="SortingName" onchange="workOnName()">
      <option value="Sort-by-name">Sort-by-name</option>
      <option value="asc">asc</option>
      <option value="dsc">dsc</option>
    </select>

    <select id="SortingSalary" onchange="workOnSalary()">
      <option value="Sort-by-Salary">Sort-by-Salary</option>
      <option value="High-to-Low">High-to-Low</option>
      <option value="Low-to-High">Low-to-High</option>
    </select>

    <select id="filterRole" onchange="workOnRole()">
      <option>Filter Category</option>
      <option value="FSD">FSD</option>
      <option value="Frontend">FRONTEND</option>
      <option value="Backend">BACKEND</option>
    </select>

    <main>
      <table>
        <thead>
          <tr>
            <th>Name</th>
            <th>Email</th>
            <th>Job applied</th>
            <th>Salary expected</th>
            <th>Add to bookmark</th>
          </tr>
        </thead>
        <tbody id="body">
          <!-- Append your output to tbody -->
        </tbody>
      </table>
    </main>
  </body>
  <script>
    //you need to code here
    var jobArr = JSON.parse(localStorage.getItem("jobList"))
    displayData(jobArr);

    var bookmarkArr =  JSON.parse(localStorage.getItem("bookmarks")) || [];



    // adding filter in it 
    function workOnRole(){
      var selected = document.querySelector("#filterRole").value;
      
      var filterItem = jobArr.filter(function (ele){
        return ele.personRole == selected;
      });
      displayData(filterItem);
    }
    // function workOnSalary(){
    //   var selected = document.querySelector("#SortingSalary").value;
    //   var findsalary = jobArr.filter(function (ele){
    //     return ele.personSalary == selected;
    //   });
    //   displayData(findsalary);
    // }
    // adding sort 
    function workOnSalary(){
      var selected = document.querySelector("#SortingSalary").value;
        if(selected=="High-to-Low"){
          jobArr.sort(function (a,b){
            return b.personSalary - a.personSalary;
        });
        displayData(jobArr);
      }

        if(selected=="Low-to-High"){
            jobArr.sort(function (a,b){
            return a.personSalary - b.personSalary;
        });
        displayData(jobArr);
      }
    }




    function workOnName(){
      var selected = document.querySelector("#SortingName").value;
       
        if(selected == "asc"){
          jobArr.sort(function (a,b){
            var x = a.personName.toUpperCase();
            var y = b.personName.toUpperCase();
            if(x>y){
              return 1;
            }
            else if(x<y){
              return -1;
            }
            return 0;
          });
        displayData(jobArr);
        console.log(jobArr);
      }

      if(selected=="dsc"){
        jobArr.sort(function(a,b) {
          var x = a.personName.toUpperCase();
          var y = b.personName.toUpperCase();

          if(x>y){
            return -1;
          }
          else if(x<y){
            return  1;
          }
          return 0;
        });
        displayData(jobArr);
      }
    }

  function displayData(data) {
    document.querySelector("tbody").innerHTML =""; // or null
    
    data.forEach(function (ele){

      var big = document.createElement("tr");
  
      var th1 = document.createElement("td");
      th1.innerText = ele.personName;
  
      var th2 = document.createElement("td");
      th2.innerText = ele.personEmail;
  
      var th3 = document.createElement("td");
      th3.innerText = ele.personRole;
  
      var th4 = document.createElement("td");
      th4.innerText = ele.personSalary;
  
      var th5 = document.createElement("td");
      th5.innerText = "Bookmark";
      th5.style.color = "royalblue"
      th5.style.cursor = "pointer"
      
      th5.addEventListener("click", function(){
        bookmarkFun(ele)
      });
  
      big.append(th1,th2,th3,th4,th5);
  
      document.querySelector("tbody").append(big);

    });
  }

  function bookmarkFun(ele){
    bookmarkArr.push(ele);
    localStorage.setItem("bookmarks",JSON.stringify(bookmarkArr));
    window.location.href = "bookmark.html";
  }
  </script>
</html>
